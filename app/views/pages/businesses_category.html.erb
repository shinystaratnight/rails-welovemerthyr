<%= render partial: "pages/banners/#{params[:cat].downcase.gsub(/\s+/, '_')}" %>

<section class="content-padding">
	<div class="row content-padding">
		<div class="column text-center medium-text-left">
			<h2>A-Z of Shopping in Merthyr Tydfil Town Centre</h2>
		</div>
	</div>
	<div id="infinite-list" class="row small-up-1 medium-up-3 content-padding" data-equalizer data-equalize-on="medium" data-equalize-by-row="true">
	</div>
  <div id="infinite-loader" class="row column content-padding">loading...</div>
</section>

<%= content_for :script do %>
  <script type="text/javascript" charset="utf-8">
    $(function(){
       //load and show the initial set of events on dashboard
       loadBusinessesForPagination(1);

       //infinite scroll events on dashboard
       window.businessesPageNum = 2;
       window.doPagination = true;
       $(window).scroll(function(){
        //if($(window).scrollTop() == $(document).height() - $(window).height()){
        if($(window).scrollTop() > $(document).height() - $(window).height() - 100){
          if(window.doPagination){
            // run call for pagination
            loadBusinessesForPagination(window.businessesPageNum);
            window.businessesPageNum++;
          }else{
            $('#infinite-loader').html('You reached the bottom.').show();
          }
        }
        });
    }) 
  </script>
<% end %>
